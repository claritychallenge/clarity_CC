# Running the baseline prediction model

To run the baseline prediction model call,

```bash
./predict.sh <DATASET>
```

where <DATASET> may be either `train` (for track1) or `train_indep` (for track2).

> ***Note**, the `predict.sh` will take a long time to run completely.

If you wish to run it on a reduced number of signals you can run

```bash
./predict.sh <DATASET> <NUM_SIGNALS>
```

e.g. `./predict.sn train 10` will run on the first 10 signals of the train set.

The preduct script runs in two stages.

- Stage 1: It calls a python script called `run_HL_processing.py` which passes all the signals through the MSBG hearing loss model. This stage will write audio files into directories under `clarity_data/HA_outputs`.
- Stage 2: It calls a python script called `calculate_SI.py` which uses the hearing loss model outputs to compute MBSTOI scores. This stage will accumulate outputs in a csv file called `mbstoi.<DATASET>.csv`

The script can be safely stopped at any stage and should resume from where it left off.

The MBSTOI scores generated by running the baseline system can be found in  `mbstoi.train.baseline.csv` and `mbstoi.train_indep.baseline.csv` for the Track1 and Track2 data respectively.

A third quick stage will shortly be released which will map the MBSTOI scores onto predicted sentence intelligibilities and then produce a final overall score for the dataset, using the CPC1 scoring metric (To be confirmed shortly).
