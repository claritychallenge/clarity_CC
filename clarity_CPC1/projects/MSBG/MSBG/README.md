# MSBG hearing loss model

(Original commentary from MATLAB code version)

Hearing impairment simulator, written by members of Auditory Perception Group, University of Cambridge, ca 1991-2013. In this version, user specifies a file in variable "roots", and this is processed for as many channels as there are in each signal file for as many times as there are audiograms in "audiogram_master()" array.

Input sound files must be at a 44100 sampling rate (CD quality).

Apart from this file, all other code is supplied as MATLAB p-code., plus some supporting .mat files used for selecting
filterbanks. When processing multi-channel signal files, the reference level is calculated from the LEFT channel only: this may not
make sense for some stereo files, but for surround sound files, some channels may have negligible signal, so we need
to decide on a reference level from somewhere. Maximum file duration that can be processed may be limited by Windows/MATLAB implementation (about 45 secs within the 2GB limited MATLABs.) Hence may need to reduce "PROC_SECS" to fit limits. Currently set to 10 secs: suggest leaving at such until happy with temporary result, and then implement full processing. User is advised to read ALL comments in this file header in order to familiarise themselves with the code function.

Note that this code relies HEAVILY on correct calibration in order to be vaguely realistic. Hence code prepends a speech-weighted calibration noise at the start of each audio signal. This is important, since it is common to compare "unprocessed" signals with "processed" signals. This is NOT wise since the calibrations may have changed between the two. To ensure the same calibrations, process signal file with a flat 0-dB audiogram at the same time as desired audiogram. The simulation outputs should then not be separated. The calibration noise in the "flat 0-dB" audiogram processing, should then be replayed at 65 dB SPL (flat weighted). The "impaired" simulations generated at the same time will then replay with no need to change the replay level.

The "spectral smearing" software has the perceptual effect of adding a certain "grittiness" to the audio quality. This is perfectly normal, since, in order to smear spectral detail, signal components have to be generated at frequencies to either side of any component in the original signal. Apart from introducing a distortion, this can also be seen as a form of loss of fidelity that might be expected due to the increasing involvement of inner rather than just outer- hair cell damage at higher degrees of loss.

1. take wav file from "roots" variable, prepend calibration tone and calibration speech-shaped noise at the start of each channel signal for each audiogram in the array "audiogram_master", process file........
2. send to MATLAB function that applies linear filtering to simulate passage from ITU/diffuse/free-field to cochlea (mainly a bass cut and a mid-range boost, does not increase the signal level)
3. write cochlea-referenced signal as 16-bit binary file for processing by DOS executable called by batch file
4. impairment simulation is done in two stages: spectral smearing and recruitment simulation
5. re-call MATLAB function of (2) above that applies INVERSE linear filtering from that in (2) (to simulate passage from cochlea to ITU/diffuse/free-field, does increase signal level)
6. write processed signal out to wav file: filename is automatically generated by adding the index of the audiogram to the input filename [AudiogX]

## REFERENCES

### Spectral smearing

- (a) T. Baer and B.C.J. Moore, "Effects of spectral smearing on the intelligibility of sentences in the presence of noise", J. Acoust. Soc. Am. 94: 1229-1241 (1993).
- (b) T. Baer and B.C.J. Moore, "Effects of spectral smearing on the intelligibility of sentences in the presence of interfering speech", J. Acoust. Soc. Am. 95: 2277-2280 (1994).

### Recruitment simulation

- B.C.J. Moore and B.R. Glasberg, "Simulation of the effects of loudness recruitment and threshold elevation on the intelligibility of speech in quiet and in a background of speech", J. Acoust. Soc. Am. 94: 2050-2062 (1993).

Filtering to equalise signal for cochlear presentation:

- M.A. Stone and B.C.J. Moore, "Tolerable hearing-aid delays. I. Estimation of limits imposed by the auditory path alone using simulated hearing losses", Ear Hear. 20: 182-192 (1999).

In the original recruitment simulation, the filter bandwidth was set to 3 times broader than "normal" (ie 3xERBn). This sort of width is suitable for severe losses, where signal bandwidth is usually limited, hence the original software was written for 16 kHz samplerate, and used 13 overlapping filters. This version, with samplerate set to 44.1 kHz was intended for more moderate losses, hence the recruitment filterbank comprises 28 filters with x2 broadening (see "cochlear_simulate.m"). however, the degree of spectral smearing, applied uniformly across frequencies, depends on the average audiogram between 2 and 8 kHz. The higher the degree of smearing, the more "fuzziness" it applies to the signal, by bringing up the level of noise between signal components. To a first order, this can be regarded as a form of degradation of IHC signal quality. Because of the non-linearity of the processing, and the overlap of the filters, this software does not (and cannot) provide an "exact" simulation, more a qualitative feel for the sorts of problems to be experienced. So if a calibration tone comes out 1-2 dB away from where one expected it to, then do not be surprised.

## CAVEATS: NOT SO APPLICABLE FOR ALL-MATLAB IMPLEMENTATION NOVEMBER 2013

1. because the cochlear signal is reduced at low and high frequencies due to middle-ear filtering, when the signal
   was sent to the recruitment simulation executable as 16-bit files,
   then suffered quantising (especially for high degrees of simulated losses). Once the inverse filter (cochlea to free
   field) is applied, effectively boosting low & high frequencies,
   then random noise appeared in the processed signal. It was then wise to limit the frequency range of the simulation,
   so as not to excite this effect. Hence parameter [UPPER_CUTOFF_HZ].

2. the recruitment simulation was written in C and has been compiled as a win-32, DOS-like executable. Since input
   and output is in 16 bits binary files, some quantising/dynamic
   range problems can arise here. MAS updated TBs smearing code so that it all ran in MATLAB.

## Calibration method

The system assumes that within a digital wav file, an RMS of [REF_RMS_DB] translates to an equivalent real-world SPL of [CALIB_DB_SPL]when we run a simulation using a filename held in variable [roots], we then have to decide at what level we wish it to be simulated, hence variable [target_roots_SPL] contains the dB SPL equivalents of what we have scaled the input files to, ie the levels at which we wish to run simulations for each file in [roots]. A variable [HEADROOM_dB] allows us to scale down the signals before sending out to the recruitment simulation. Even so, [cochlear_simulate] checks to see if clipping will occur, and prints a warning if < 20 clips occur,
or stops if >= 20. [measure_rms] is a sophisticated method of measuring RMS in a file: it splits the signal up into 10 msec durations, performs a histogram of levels, calculates an approximate RMS, and then uses that RMS to calculate a threshold level in the histogram and then re-measures the RMS only using those durations whose individual RMS exceed that threshold. In this way it avoids that the RMS measure is influenced by long periods of near-silence.
